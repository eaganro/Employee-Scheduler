DROP DATABASE IF EXISTS scheduler;

CREATE DATABASE scheduler;

USE scheduler;

CREATE TABLE users (
  id INTEGER NOT NULL AUTO_INCREMENT,
  username VARCHAR(255) NOT NULL UNIQUE,
  password VARCHAR(255) NOT NULL,
  createdate DATE NOT NULL,
  PRIMARY KEY (id)
);

CREATE TABLE employees (
  id INTEGER NOT NULL AUTO_INCREMENT,
  name varchar(50) NOT NULL,
  user_id INTEGER NOT NULL,
  PRIMARY KEY (id),
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
  UNIQUE KEY name (name, user_id)
);

CREATE TABLE calendars (
  id INTEGER NOT NULL AUTO_INCREMENT,
  name varchar(50) NOT NULL,
  user_id INTEGER NOT NULL,
  PRIMARY KEY (id),
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
  UNIQUE KEY name (name, user_id)
);

CREATE TABLE times (
  id INTEGER NOT NULL AUTO_INCREMENT,
  time000 varchar(10) NOT NULL,
  time001 varchar(10) NOT NULL,
  time002 varchar(10) NOT NULL,
  time003 varchar(10) NOT NULL,
  time010 varchar(10) NOT NULL,
  time011 varchar(10) NOT NULL,
  time012 varchar(10) NOT NULL,
  time013 varchar(10) NOT NULL,
  time020 varchar(10) NOT NULL,
  time021 varchar(10) NOT NULL,
  time022 varchar(10) NOT NULL,
  time023 varchar(10) NOT NULL,
  time030 varchar(10) NOT NULL,
  time031 varchar(10) NOT NULL,
  time032 varchar(10) NOT NULL,
  time033 varchar(10) NOT NULL,
  time040 varchar(10) NOT NULL,
  time041 varchar(10) NOT NULL,
  time042 varchar(10) NOT NULL,
  time043 varchar(10) NOT NULL,
  time050 varchar(10) NOT NULL,
  time051 varchar(10) NOT NULL,
  time052 varchar(10) NOT NULL,
  time053 varchar(10) NOT NULL,
  time060 varchar(10) NOT NULL,
  time061 varchar(10) NOT NULL,
  time062 varchar(10) NOT NULL,
  time063 varchar(10) NOT NULL,
  time070 varchar(10) NOT NULL,
  time071 varchar(10) NOT NULL,
  time072 varchar(10) NOT NULL,
  time073 varchar(10) NOT NULL,
  time080 varchar(10) NOT NULL,
  time081 varchar(10) NOT NULL,
  time082 varchar(10) NOT NULL,
  time083 varchar(10) NOT NULL,
  time090 varchar(10) NOT NULL,
  time091 varchar(10) NOT NULL,
  time092 varchar(10) NOT NULL,
  time093 varchar(10) NOT NULL,
  time100 varchar(10) NOT NULL,
  time101 varchar(10) NOT NULL,
  time102 varchar(10) NOT NULL,
  time103 varchar(10) NOT NULL,
  time110 varchar(10) NOT NULL,
  time111 varchar(10) NOT NULL,
  time112 varchar(10) NOT NULL,
  time113 varchar(10) NOT NULL,
  time120 varchar(10) NOT NULL,
  time121 varchar(10) NOT NULL,
  time122 varchar(10) NOT NULL,
  time123 varchar(10) NOT NULL,
  time130 varchar(10) NOT NULL,
  time131 varchar(10) NOT NULL,
  time132 varchar(10) NOT NULL,
  time133 varchar(10) NOT NULL,
  time140 varchar(10) NOT NULL,
  time141 varchar(10) NOT NULL,
  time142 varchar(10) NOT NULL,
  time143 varchar(10) NOT NULL,
  time150 varchar(10) NOT NULL,
  time151 varchar(10) NOT NULL,
  time152 varchar(10) NOT NULL,
  time153 varchar(10) NOT NULL,
  time160 varchar(10) NOT NULL,
  time161 varchar(10) NOT NULL,
  time162 varchar(10) NOT NULL,
  time163 varchar(10) NOT NULL,
  time170 varchar(10) NOT NULL,
  time171 varchar(10) NOT NULL,
  time172 varchar(10) NOT NULL,
  time173 varchar(10) NOT NULL,
  time180 varchar(10) NOT NULL,
  time181 varchar(10) NOT NULL,
  time182 varchar(10) NOT NULL,
  time183 varchar(10) NOT NULL,
  time190 varchar(10) NOT NULL,
  time191 varchar(10) NOT NULL,
  time192 varchar(10) NOT NULL,
  time193 varchar(10) NOT NULL,
  time200 varchar(10) NOT NULL,
  time201 varchar(10) NOT NULL,
  time202 varchar(10) NOT NULL,
  time203 varchar(10) NOT NULL,
  time210 varchar(10) NOT NULL,
  time211 varchar(10) NOT NULL,
  time212 varchar(10) NOT NULL,
  time213 varchar(10) NOT NULL,
  time220 varchar(10) NOT NULL,
  time221 varchar(10) NOT NULL,
  time222 varchar(10) NOT NULL,
  time223 varchar(10) NOT NULL,
  time230 varchar(10) NOT NULL,
  time231 varchar(10) NOT NULL,
  time232 varchar(10) NOT NULL,
  time233 varchar(10) NOT NULL,
  user_id INTEGER NOT NULL,
  PRIMARY KEY (id),
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

CREATE TABLE shifts (
  id INTEGER NOT NULL AUTO_INCREMENT,
  week INTEGER NOT NULL,
  day INTEGER NOT NULL,
  employee_id INTEGER NOT NULL,
  time_id INTEGER NOT NULL,
  user_id INTEGER NOT NULL,
  calendar_id INTEGER NOT NULL,
  PRIMARY KEY (id),
  FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE CASCADE,
  FOREIGN KEY (time_id) REFERENCES times(id) ON DELETE CASCADE,
  FOREIGN KEY (calendar_id) REFERENCES calendars(id) ON DELETE CASCADE,
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
  UNIQUE KEY week (week, day, employee_id, user_id, calendar_id)
);

INSERT INTO users (username, password) VALUES ('rory', 'eagan');
